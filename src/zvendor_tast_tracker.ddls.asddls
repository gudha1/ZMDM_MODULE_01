@AbapCatalog.sqlViewName: 'ZVEN_TRACK2'
@AbapCatalog.compiler.compareFilter: true
@AbapCatalog.preserveKey: true
@AccessControl.authorizationCheck: #NOT_REQUIRED
@EndUserText.label: 'Vendor task tracker'
@Metadata.ignorePropagatedAnnotations: true
define view ZVENDOR_TAST_TRACKER as select from zgeneraldata as a
left outer join zuser_id as c on (c.userid = a.login_id )
left outer join ZAPPROVAL_ID as d on ( a.appid = '' )
left outer join zuser_id as e on ( e.userid = d.appr_id or e.userid = a.appid )
left outer join I_RegionText as F on ( F.Region = a.region and F.Language = 'E' and F.Country = a.countryreg1)
left outer join I_CountryText as G on ( G.Country = a.countryreg1 and G.Language = 'E' )
{
   key a.taskid as Taskid,
    a.businesspartner as Businesspartner,
    a.createbp as Createbp,
    a.grouping as Grouping,
    a.title as Title,
    a.name as Name,
    a.addname as Addname,
    a.name1 as Name1,
    a.name2 as Name2,
    a.firstname as Firstname,
    a.lastname as Lastname,
    a.language as Language,
    a.search1 as Search1,
    a.search2 as Search2,
    a.vip as Vip,
    a.undesirablecustomer as Undesirablecustomer,
    a.reason as Reason,
    a.specialcomment as Specialcomment,
    a.street1 as Street1,
    a.street2 as Street2,
    a.postal1 as Postal1,
    a.postal2 as Postal2,
    a.country as Country,
    a.region as Region,
    a.pobox as Pobox,
    a.postalcode as Postalcode,
    a.companycodepostal as Companycodepostal,
    a.telephone as Telephone,
    a.mobilephone as Mobilephone,
    a.fax as Fax,
    a.email as Email,
    a.comments as Comments,
    a.addressvalidfrom as Addressvalidfrom,
    a.addressvalidto as Addressvalidto,
    a.externaladdress as Externaladdress,
    a.addresstelephone as Addresstelephone,
    a.addressmobilephone as Addressmobilephone,
    a.addressfax as Addressfax,
    a.addressemail as Addressemail,
    a.legalform as Legalform,
    a.legalentity as Legalentity,
    a.datefounded as Datefounded,
    a.liquidation as Liquidation,
    a.intlocation as Intlocation,
    a.intlocation2 as Intlocation2,
    a.checkdigit as Checkdigit,
    a.factorycalendar as Factorycalendar,
    a.externalbp as Externalbp,
    a.military as Military,
    a.nuclear as Nuclear,
    a.bptype as Bptype,
    a.authorizationgroup as Authorizationgroup,
    a.printformat as Printformat,
    a.tradingpartnerno as Tradingpartnerno,
    a.groupingcharact as Groupingcharact,
    a.dataorigin as Dataorigin,
    a.encorrespondence as Encorrespondence,
    a.enaccountingnote as Enaccountingnote,
    a.enmarketingnote as Enmarketingnote,
    a.enbusinesshours as Enbusinesshours,
    a.ennotelog as Ennotelog,
    a.enipmtest as Enipmtest,
    a.enoutboundpackinginstruc as Enoutboundpackinginstruc,
    a.envendordescription as Envendordescription,
    a.archivingflag as Archivingflag,
    a.centralblock as Centralblock,
    a.notreleased as Notreleased,
    a.contact as Contact,
    a.enddate as Enddate,
    a.contactdate as Contactdate,
    a.targetgroup as Targetgroup,
    a.countryregion as Countryregion,
    a.registeredregion as Registeredregion,
    a.registeredregoffice as Registeredregoffice,
    a.balancebalsheetcrcy as Balancebalsheetcrcy,
    a.balsheetdisp as Balsheetdisp,
    a.capitincrease as Capitincrease,
    a.zyear as Zyear,
    a.vendornumber as Vendornumber,
    a.supplieraccountgroup as Supplieraccountgroup,
    a.generalcustomer as Generalcustomer,
    a.generalauthorizationgroup as Generalauthorizationgroup,
    a.groupkey as Groupkey,
    a.repetition as Repetition,
    a.dtelimitid as Dtelimitid,
    a.trainstation as Trainstation,
    a.originacceptance as Originacceptance,
    a.dmerecipientcode as Dmerecipientcode,
    a.instructionkey as Instructionkey,
    a.payeeindocument as Payeeindocument,
    a.alternativepayee as Alternativepayee,
    a.pbcisrnumber as Pbcisrnumber,
    a.paymentreason as Paymentreason,
    a.socialinsurance as Socialinsurance,
    a.socialinscode as Socialinscode,
    a.stdcarracccode as Stdcarracccode,
    a.carfreightgroup as Carfreightgroup,
    a.statsgroupagent as Statsgroupagent,
    a.serviceagentproc as Serviceagentproc,
    a.profession as Profession,
    a.externalmanuf as Externalmanuf,
    a.podrelevant as Podrelevant,
    a.carrierconfirmation as Carrierconfirmation,
    a.paymentblock as Paymentblock,
    a.altpayee as Altpayee,
    a.cstno as Cstno,
    a.lstno as Lstno,
    a.serregno as Serregno,
    a.pan as Pan,
    a.panreference as Panreference,
    a.pandate as Pandate,
    a.deducteerefno as Deducteerefno,
    a.category as Category,
    a.categoryname as Categoryname,
    a.tablename as Tablename,
    a.taxnumberlong as Taxnumberlong,
    a.taxregstatus as Taxregstatus,
    a.id as Id,
    a.cr as Cr,
    a.bankkey as Bankkey,
    a.bankaccount as Bankaccount,
    a.controlkey as Controlkey,
    a.iban as Iban,
    a.bankaccountalias as Bankaccountalias,
    a.referencedetails as Referencedetails,
    a.extid as Extid,
    a.accountholder as Accountholder,
    a.accountname as Accountname,
    a.buildingcode as Buildingcode,
    a.room as Room,
    a.floor as Floor,
    a.street3 as Street3,
    a.streethousenumber as Streethousenumber,
    a.street4 as Street4,
    a.street5 as Street5,
    a.district as District,
    a.differentcity as Differentcity,
    a.co as Co,
    a.countryreg1 as Countryreg1,
    a.ztimezone as Ztimezone,
    a.taxjuris as Taxjuris,
    a.transportationzone as Transportationzone,
    a.structuregroup as Structuregroup,
    a.undeliverable as Undeliverable,
    a.gendata_plant as GendataPlant,
    a.factorycalendra as Factorycalendra,
    a.vsr_relevant as VsrRelevant,
    a.plant_relevant as PlantRelevant,
    a.housenumber as Housenumber,
    a.city as City,
    a.gstvenclass as Gstvenclass,
    a.created_by as CreatedBy,
    a.created_date as CreatedDate,
    a.created_time as CreatedTime,
    a.login_id,
    c.username as                         CreatedLoginidName    ,
    a.change_by as ChangeBy,
    a.change_date as ChangeDate,
    a.change_time as ChangeTime,
    a.change_login_id as ChangeLoginId,
//    a.apstatus as Apstatus,
    e.userid as                           ApprovedByAppid,  
    e.username as                         ApprovedByAppidName,  
    a.app_date as AppDate,
    a.app_time as AppTime,
    a.unappid as Unappid,
    a.unapp_date as UnappDate,
    a.unapp_time as UnappTime,
    a.reject as Reject,
    a.flag as Flag,
    case when a.reject = 'X' then 'Rejected'
    when a.apstatus = 'X' then 'Approved' 
    when a.flag = 'X' then 'Deleted' 
    else 'Pending For Approval' 
    end as ApproveStatus,
    F.RegionName ,
    G.CountryName
}

